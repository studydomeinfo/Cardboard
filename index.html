<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Study Dome - Post Editor</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>
<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        primary: '#FF6B00'
      }
    }
  }
}
</script>
</head>
<body class="bg-gray-100">
  <!-- Simple Header -->
  <header class="bg-white shadow-sm">
    <div class="max-w-4xl mx-auto px-6 py-4">
      <div class="flex items-center justify-between">
        <h1 class="text-xl font-bold text-primary">Study Dome Post Editor</h1>
        <button id="export-btn" class="bg-primary text-white px-4 py-2 rounded hover:bg-orange-600">
          Export Post
        </button>
      </div>
    </div>
  </header>

  <!-- Simple Form -->
  <div class="max-w-4xl mx-auto px-6 py-8">
    <div class="bg-white rounded p-6 space-y-4">
      
      <!-- Post ID -->
      <div>
        <label class="block text-sm font-medium mb-1">Post ID (filename)</label>
        <input type="text" id="post-id" placeholder="full-scholarship-opportunities" class="w-full px-3 py-2 border rounded">
      </div>

      <!-- Title -->
      <div>
        <label class="block text-sm font-medium mb-1">Title</label>
        <input type="text" id="post-title" placeholder="Post title" class="w-full px-3 py-2 border rounded">
      </div>

      <!-- Description -->
      <div>
        <label class="block text-sm font-medium mb-1">Description</label>
        <textarea id="post-description" rows="2" placeholder="Post description" class="w-full px-3 py-2 border rounded"></textarea>
      </div>

      <!-- Category -->
      <div>
        <label class="block text-sm font-medium mb-1">Category</label>
        <select id="post-category" class="w-full px-3 py-2 border rounded">
          <option value="Scholarship">Scholarship</option>
          <option value="Campus News">Campus News</option>
          <option value="Academic Tips">Academic Tips</option>
          <option value="Student Life">Student Life</option>
          <option value="Study Tips">Study Tips</option>
          <option value="Healthcare">Healthcare</option>
          <option value="Events">Events</option>
        </select>
      </div>

      <!-- Image URL -->
      <div>
        <label class="block text-sm font-medium mb-1">Featured Image URL</label>
        <input type="url" id="post-image" placeholder="https://example.com/image.jpg" class="w-full px-3 py-2 border rounded">
      </div>



      <!-- Content -->
      <div>
        <label class="block text-sm font-medium mb-1">Content (Markdown)</label>
        <textarea id="post-content" rows="15" placeholder="Write your post content in Markdown..." class="w-full px-3 py-2 border rounded font-mono text-sm"></textarea>
        <p class="text-xs text-gray-500 mt-1">Use Markdown: **bold**, *italic*, ## headings, - lists, > blockquotes</p>
      </div>
    </div>
  </div>

  <!-- Export Modal -->
  <div id="export-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-white rounded p-6 max-w-4xl w-full mx-4 max-h-96">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-semibold">Export Post</h3>
        <button id="close-modal" class="text-gray-500 hover:text-gray-700">âœ•</button>
      </div>
      <p class="mb-4">Save as: <span id="filename-display" class="font-mono bg-gray-100 px-2 py-1 rounded">post.html</span></p>
      <textarea id="export-code" class="w-full h-64 px-3 py-2 border rounded font-mono text-xs overflow-auto" readonly></textarea>
      <div class="flex gap-3 mt-4">
        <button id="copy-code" class="bg-primary text-white px-4 py-2 rounded hover:bg-orange-600">Copy Code</button>
        <button id="download-file" class="bg-gray-200 text-gray-700 px-4 py-2 rounded hover:bg-gray-300">Download File</button>
      </div>
    </div>
  </div>

  <script>
    function getCurrentDate() {
      const now = new Date();
      const options = { year: 'numeric', month: 'long', day: 'numeric' };
      return now.toLocaleDateString('en-US', options);
    }

    function getCategoryColors(category) {
      const colors = {
        'Scholarship': 'bg-orange-100 text-orange-700',
        'Campus News': 'bg-blue-100 text-blue-700',
        'Academic Tips': 'bg-green-100 text-green-700',
        'Student Life': 'bg-purple-100 text-purple-700',
        'Study Tips': 'bg-green-100 text-green-700',
        'Healthcare': 'bg-red-100 text-red-700',
        'Events': 'bg-yellow-100 text-yellow-700',
        'Finance': 'bg-blue-100 text-blue-700'
      };
      return colors[category] || 'bg-gray-100 text-gray-700';
    }

    function generatePostHTML() {
      const postId = document.getElementById('post-id').value || 'post';
      const title = document.getElementById('post-title').value || 'Untitled Post';
      const description = document.getElementById('post-description').value || 'Post description';
      const category = document.getElementById('post-category').value;
      const image = document.getElementById('post-image').value || 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&h=400&fit=crop';
      const content = document.getElementById('post-content').value || 'No content provided.';

      const categoryColors = getCategoryColors(category);
      const currentDate = getCurrentDate();
      const parsedContent = marked.parse(content);

      return `<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>${title} - Study Dome</title>
<script src="https://cdn.tailwindcss.com"><\/script>
<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        primary: '#FF6B00'
      }
    }
  }
}
<\/script>
<style>
.related-post:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(255, 107, 0, 0.1);
  transition: all 0.2s ease;
}

a{
    background-color:orange;  
      }
.share-btn:hover {
  transform: translateY(-1px);
  transition: all 0.2s ease;
}

.article-content h2 {
  font-size: 1.5rem;
  font-weight: 600;
  margin: 2rem 0 1rem 0;
  color: #1f2937;
}

.article-content h3 {
  font-size: 1.25rem;
  font-weight: 600;
  margin: 1.5rem 0 0.75rem 0;
  color: #374151;
}

.article-content p {
  margin-bottom: 1rem;
  line-height: 1.7;
}

.article-content ul {
  margin: 1rem 0;
  padding-left: 1.5rem;
}

.article-content li {
  margin-bottom: 0.5rem;
  list-style-type: disc;
}

.article-content blockquote {
  border-left: 4px solid #FF6B00;
  padding-left: 1rem;
  margin: 1.5rem 0;
  font-style: italic;
  color: #6b7280;
}

.article-content strong {
  font-weight: 600;
}

.article-content em {
  font-style: italic;
}

.article-content code {
  background-color: #f3f4f6;
  padding: 0.125rem 0.25rem;
  border-radius: 0.25rem;
  font-family: monospace;
  font-size: 0.875rem;
}

.article-content pre {
  background-color: #f3f4f6;
  padding: 1rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  margin: 1rem 0;
}

.article-content pre code {
  background-color: transparent;
  padding: 0;
}
<\/style>
</head>
<body class="bg-gray-50">
  <!-- Header -->
  <header class="bg-white shadow-sm">
    <div class="max-w-6xl mx-auto px-6 py-4">
      <div class="flex items-center justify-between">
        <a href="/" class="text-2xl font-bold text-primary">Study Dome</a>
        <nav class="hidden md:flex items-center space-x-6">
          <a href="/" class="text-gray-600 hover:text-primary transition-colors">Home</a>
          <a href="#" class="text-gray-600 hover:text-primary transition-colors">Scholarships</a>
          <a href="#" class="text-gray-600 hover:text-primary transition-colors">Campus News</a>
          <a href="#" class="text-gray-600 hover:text-primary transition-colors">Academic Tips</a>
        </nav>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="max-w-4xl mx-auto px-6 py-8">
    <!-- Article Header -->
    <header class="mb-8">
      <div class="flex items-center gap-2 mb-4">
        <span class="${categoryColors} px-3 py-1 rounded-full text-sm font-medium">${category}</span>
        <span class="text-gray-500 text-sm">${currentDate}</span>
      </div>
      
      <h1 class="text-4xl font-bold text-gray-900 mb-4 leading-tight">
        ${title}
      </h1>
      
      <p class="text-xl text-gray-600 leading-relaxed mb-6">
        ${description}
      </p>

      <!-- Share Buttons -->
      <div class="flex items-center gap-3 mb-8">
        <span class="text-sm text-gray-600 font-medium">Share:</span>
        <button onclick="shareOnTwitter()" class="share-btn bg-blue-500 text-white p-2 rounded-lg hover:bg-blue-600">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/>
          </svg>
        </button>
        <button onclick="shareOnFacebook()" class="share-btn bg-blue-700 text-white p-2 rounded-lg hover:bg-blue-800">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
          </svg>
        </button>
        <button onclick="shareOnWhatsApp()" class="share-btn bg-green-500 text-white p-2 rounded-lg hover:bg-green-600">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
          </svg>
        </button>
      </div>

      <!-- Featured Image -->
      <img src="${image}" alt="${title}" class="w-full h-64 md:h-80 object-cover rounded-lg mb-8">
    </header>

    <!-- Article Content -->
    <div class="prose prose-lg max-w-none">
      <div class="article-content text-gray-700 leading-relaxed">
        ${parsedContent}
      </div>
    </div>

    <!-- Newsletter Signup -->
    <div class="mt-12 bg-gradient-to-r from-orange-50 to-white p-8 rounded-lg">
      <div class="text-center">
        <h3 class="text-2xl font-bold text-gray-900 mb-2">Stay Updated on Scholarship Opportunities</h3>
        <p class="text-gray-600 mb-6">Get the latest scholarship news and application tips delivered to your inbox weekly.</p>
        <form id="newsletter-form" class="flex max-w-md mx-auto gap-2">
          <input type="email" id="newsletter-email" placeholder="Enter your email" required class="flex-1 px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
          <button type="submit" class="bg-primary text-white px-6 py-3 rounded-lg hover:bg-orange-600 transition-colors whitespace-nowrap">
            Subscribe
          </button>
        </form>
        <div id="newsletter-message" class="mt-4 text-sm hidden"></div>
      </div>
    </div>

    <!-- Related Posts -->
    <section class="mt-16">
      <h3 class="text-2xl font-bold text-gray-900 mb-8">Related Articles</h3>
      <div id="related-posts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Related posts will be loaded here -->
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-white border-t py-8 mt-16">
    <div class="max-w-6xl mx-auto px-6 text-center">
      <div class="mb-6">
        <h3 class="text-xl font-bold text-primary mb-2">Study Dome</h3>
        <p class="text-gray-600">Your trusted source for academic opportunities</p>
      </div>
      <div class="flex justify-center gap-6 mb-6">
        <a href="#" class="text-gray-600 hover:text-primary">Scholarships</a>
        <a href="#" class="text-gray-600 hover:text-primary">Campus News</a>
        <a href="#" class="text-gray-600 hover:text-primary">Academic Tips</a>
        <a href="#" class="text-gray-600 hover:text-primary">Contact</a>
      </div>
      <p class="text-gray-500 text-sm">Â© 2025 Study Dome. All rights reserved.</p>
    </div>
  </footer>
      
  <!-- Back to Top Button -->
  <button id="back-to-top" class="fixed bottom-6 right-6 bg-primary text-white p-3 rounded-full shadow-lg hover:bg-orange-600 transition-colors opacity-0 invisible">
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
    </svg>
  </button>

  <script>
    // Get category colors for related posts
    function getCategoryColors(category) {
      const colors = {
        'Scholarship': 'bg-orange-100 text-orange-700',
        'Campus News': 'bg-blue-100 text-blue-700',
        'Academic Tips': 'bg-green-100 text-green-700',
        'Student Life': 'bg-purple-100 text-purple-700',
        'Events': 'bg-yellow-100 text-yellow-700',
        'Study Tips': 'bg-green-100 text-green-700',
        'Finance': 'bg-blue-100 text-blue-700'
      };
      return colors[category] || 'bg-gray-100 text-gray-700';
    }

    // Load and display related posts
    function loadRelatedPosts() {
      fetch('./posts.json')
        .then(response => response.json())
        .then(posts => {
          // Get current post title to exclude it from related posts
          const currentTitle = "${title}";
          
          // Filter out current post and get random 3 posts
          const otherPosts = posts.filter(post => post.title !== currentTitle);
          const shuffled = otherPosts.sort(() => 0.5 - Math.random());
          const relatedPosts = shuffled.slice(0, 3);
          
          const relatedContainer = document.getElementById('related-posts');
          relatedContainer.innerHTML = relatedPosts.map(post => {
            const categoryColors = getCategoryColors(post.category);
            return \`
              <article class="related-post bg-white rounded-lg shadow-sm overflow-hidden">
                <a href="\${post.link}" class="block">
                  <img src="\${post.image}" alt="\${post.title}" class="w-full h-40 object-cover">
                  <div class="p-4">
                    <span class="\${categoryColors} px-2 py-1 rounded-full text-xs font-medium mb-2 inline-block">\${post.category}</span>
                    <h4 class="font-semibold text-gray-900 mb-2">\${post.title}</h4>
                    <p class="text-gray-600 text-sm mb-3">\${post.description}</p>
                    <span class="text-primary font-medium text-sm hover:underline">Read More â†’</span>
                  </div>
                </a>
              </article>
            \`;
          }).join('');
        })
        .catch(error => {
          console.error('Error loading related posts:', error);
          // Fallback content if posts.json can't be loaded
          document.getElementById('related-posts').innerHTML = \`
            <div class="col-span-full text-center text-gray-500 py-8">
              <p>Related posts could not be loaded.</p>
            </div>
          \`;
        });
    }

    // Load related posts when page loads
    document.addEventListener('DOMContentLoaded', loadRelatedPosts);

    // Share functions
    function shareOnTwitter() {
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent('''${title} - ${description}''');
      window.open(\`https://twitter.com/intent/tweet?url=\${url}&text=\${text}\`, '_blank');
    }

    function shareOnFacebook() {
      const url = encodeURIComponent(window.location.href);
      window.open(\`https://www.facebook.com/sharer/sharer.php?u=\${url}\`, '_blank');
    }

    function shareOnWhatsApp() {
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent('''${title} - ${description}''');
      window.open(\`https://wa.me/?text=\${text} \${url}\`, '_blank');
    }

    // Newsletter subscription
    document.getElementById('newsletter-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const email = document.getElementById('newsletter-email').value;
      const messageDiv = document.getElementById('newsletter-message');
      const submitBtn = this.querySelector('button[type="submit"]');
      
      // Show loading state
      submitBtn.textContent = 'Subscribing...';
      submitBtn.disabled = true;
      
      // ConvertKit API call
      fetch('https://api.convertkit.com/v3/forms/8394887/subscribe', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          api_key: 'z8l9OvcWFsg5r1ZltLnVGQ',
          email: email
        })
      })
      .then(response => response.json())
      .then(data => {
        if (data.subscription) {
          messageDiv.textContent = 'Successfully subscribed! Check your email for confirmation. It may be in the spam folder';
          messageDiv.className = 'mt-4 text-sm text-green-600 block';
          document.getElementById('newsletter-email').value = '';
        } else {
          throw new Error('Subscription failed');
        }
      })
      .catch(error => {
        console.error('Newsletter subscription error:', error);
        messageDiv.textContent = 'Something went wrong. Please try again.';
        messageDiv.className = 'mt-4 text-sm text-red-600 block';
      })
      .finally(() => {
        submitBtn.textContent = 'Subscribe';
        submitBtn.disabled = false;
        messageDiv.classList.remove('hidden');
        
        // Hide message after 5 seconds
        setTimeout(() => {
          messageDiv.classList.add('hidden');
        }, 5000);
      });
    });

    // Back to top functionality
    const backToTopButton = document.getElementById('back-to-top');
    
    window.addEventListener('scroll', function() {
      if (window.scrollY > 300) {
        backToTopButton.classList.remove('opacity-0', 'invisible');
        backToTopButton.classList.add('opacity-100', 'visible');
      } else {
        backToTopButton.classList.add('opacity-0', 'invisible');
        backToTopButton.classList.remove('opacity-100', 'visible');
      }
    });

    backToTopButton.addEventListener('click', function() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });
  <\/script>
</body>
</html>`;
    }

    // Function to update posts.json
    function updatePostsJSON() {
      const postId = document.getElementById('post-id').value || 'post';
      const title = document.getElementById('post-title').value || 'Untitled Post';
      const description = document.getElementById('post-description').value || 'Post description';
      const category = document.getElementById('post-category').value;
      const image = document.getElementById('post-image').value || 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&h=400&fit=crop';
      
      // Get current date in YYYY-MM-DD format
      const currentDate = new Date().toISOString().split('T')[0];
      
      const newPost = {
        title: title,
        category: category,
        description: description,
        image: image,
        date: currentDate,
        link: `${postId}.html`
      };

      // Fetch existing posts.json from the live site, add new post, and return updated JSON
      return fetch('https://studydome.netlify.app/posts.json')
        .then(response => {
          if (!response.ok) {
            // If file doesn't exist, start with empty array
            return [];
          }
          return response.json();
        })
        .then(posts => {
          // Add new post to the beginning of the array
          posts.unshift(newPost);
          return JSON.stringify(posts, null, 2);
        })
        .catch(error => {
          console.warn('Could not fetch existing posts.json from live site, creating new one:', error);
          // If there's an error, create a new array with just this post
          return JSON.stringify([newPost], null, 2);
        });
    }

    // Event Listeners
    document.getElementById('export-btn').addEventListener('click', function() {
      const postId = document.getElementById('post-id').value || 'post';
      const html = generatePostHTML();
      
      // Generate updated posts.json
      updatePostsJSON().then(updatedJSON => {
        const exportContent = `HTML File (${postId}.html):\n${html}\n\n` +
                             `Updated posts.json:\n${updatedJSON}`;
        
        document.getElementById('export-code').value = exportContent;
        document.getElementById('filename-display').textContent = `${postId}.html + posts.json`;
        document.getElementById('export-modal').classList.remove('hidden');
      });
    });

    document.getElementById('close-modal').addEventListener('click', function() {
      document.getElementById('export-modal').classList.add('hidden');
    });

    document.getElementById('copy-code').addEventListener('click', function() {
      const code = document.getElementById('export-code');
      code.select();
      document.execCommand('copy');
      alert('Code copied to clipboard!');
    });

    document.getElementById('download-file').addEventListener('click', function() {
      const postId = document.getElementById('post-id').value || 'post';
      const exportContent = document.getElementById('export-code').value;
      
      // Split the content to get HTML and JSON parts
      const parts = exportContent.split('\n\nUpdated posts.json:\n');
      const html = parts[0].replace('HTML File (' + postId + '.html):\n', '');
      const json = parts[1] || '[]';
      
      // Download HTML file
      const htmlBlob = new Blob([html], { type: 'text/html' });
      const htmlUrl = URL.createObjectURL(htmlBlob);
      const htmlLink = document.createElement('a');
      htmlLink.href = htmlUrl;
      htmlLink.download = postId + '.html';
      document.body.appendChild(htmlLink);
      htmlLink.click();
      document.body.removeChild(htmlLink);
      URL.revokeObjectURL(htmlUrl);
      
      // Download JSON file
      const jsonBlob = new Blob([json], { type: 'application/json' });
      const jsonUrl = URL.createObjectURL(jsonBlob);
      const jsonLink = document.createElement('a');
      jsonLink.href = jsonUrl;
      jsonLink.download = 'posts.json';
      document.body.appendChild(jsonLink);
      jsonLink.click();
      document.body.removeChild(jsonLink);
      URL.revokeObjectURL(jsonUrl);
      
      alert('Both files downloaded! \n\n1. Save the HTML file in your posts folder\n2. Replace the existing posts.json with the new one\n3. Upload both to update your live site');
    });
  </script>
</body>
</html>
